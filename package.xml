<?xml version="1.0" encoding="utf-8"?>
<package
  name="ROFSim"
  displayName="ROF SyncroSim Package"
  version="0.2.5">
  <!-- Transformers -->
  <transformers>
    <transformer name="Primary" isPrimary="True">
      <runtime>
        <transformer name="ProcessSpadesOutputs"/>
        <transformer name="RunCaribouRSF"/>
      </runtime>
    </transformer>
    <transformer
      name="ProcessSpadesOutputs"
      userRunnable="True"
      runContext="LocalOnly"
      programName="Rscript"
      programArguments="process_spades_outputs.R">
      <datafeeds>
        <!-- Scenario Datafeeds -->
        <datafeed name="InputSpadesObject" displayName="SpaDES" dataScope="Scenario">
          <datasheets>
            <datasheet name="InputSpadesObject" displayName="SpaDES" isSingleRow="True">
              <columns>
                <column name="ScenarioID" dataType="Integer" isPrimary="True"/>
                <column name="Filename" displayName="SpaDES Object Path" dataType="String" allowDbNull="False" isExternalFile="True"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
      </datafeeds>
    </transformer>
    <transformer
      name="RunCaribouRSF"
      userRunnable="True"
      runContext="AllowRemote"
      programName="Rscript"
      className="SyncroSim.StochasticTime.StochasticTimeTransformer"
      classAssembly="SyncroSim.StochasticTime"
      configurationSheet="ROFSim_RunControl"
      programArguments="run_caribou_model.R">
      <datafeeds>
        <!-- Project Datafeeds -->
        <datafeed name="FriLookUpTable" displayName="Forest Units" dataScope="Project">
          <datasheets>
            <datasheet name="FriLookUpTable" displayName="Forest Units">
              <columns>
                <column name="FriLookUpTableID" dataType="Integer" isPrimary="True"/>
                <column name="ProjectID" dataType="Integer"/>
                <column name="RFU" displayName="Forest Unit" dataType="String"/>
                <column name="ID" displayName="Forest Unit ID" dataType="Integer"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="CaribouRanges" displayName="Caribou Ranges" dataScope="Project">
          <datasheets>
            <datasheet name="CaribouRanges" displayName="Caribou Ranges" valueMember="CaribouRangesID" displayMember="Ranges">
              <columns>
                <column name="CaribouRangesID" dataType="Integer" isPrimary="True"/>
                <column name="ProjectID" dataType="Integer"/>
                <column name="Ranges" displayName="Range Name" dataType="String" allowDbNull="False"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="Seasons" displayName="Seasons" dataScope="Project">
          <datasheets>
            <datasheet name="Seasons" displayName="Seasons" valueMember="SeasonsID" displayMember="Season">
              <columns>
                <column name="SeasonsID" dataType="Integer" isPrimary="True"/>
                <column name="ProjectID" dataType="Integer"/>
                <column name="Season" displayName="Season Name" dataType="String" allowDbNull="False"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <!-- Scenario Datafeeds -->
        <datafeed name="RunControl" displayName="Run Control" dataScope="Scenario">
          <datasheets>
            <datasheet name="RunControl" displayName="Run Control" isSingleRow="True">
              <columns>
                <column name="RunControlID" dataType="Integer" isPrimary="True"/>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="MinimumIteration" isVisible="False" displayName="Minimum Iteration" dataType="Integer" defaultValue="1" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="1" format="d"/>
                <column name="MaximumIteration" displayName="Total Iterations" dataType="Integer" defaultValue="1" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="1" format="d"/>
                <column name="MinimumTimestep" displayName="Minimum Timestep" dataType="Integer" defaultValue="0" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" format="d"/>
                <column name="MaximumTimestep" displayName="Maximum Timestep" dataType="Integer" defaultValue="0" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" format="d"/>
              </columns>
              <validations>
                <validation validationType="LessEqual" columns="MinimumIteration|MaximumIteration"/>
                <validation validationType="LessEqual" columns="MinimumTimestep|MaximumTimestep"/>
              </validations>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="SpatialInputsRasters" displayName="Input Rasters" dataScope="Scenario">
          <datasheets>
            <datasheet name="SpatialInputsRasters" displayName="Rasters">
              <columns>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="Iteration" dataType="Integer" validationType="WholeNumber" validationCondition="Greater" formula1="0" format="d" isOptional="True"/>
                <column name="Timestep" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isOptional="True"/>
                <column name="PlcFileName" displayName="Land Cover File path" dataType="String" isExternalFile="True" allowDbNull="False" isRaster="True"/>
                <column name="FriFileName" displayName="FRI File Path" dataType="String" isExternalFile="True" allowDbNull="False" isRaster="True"/>
                <column name="AgeFileName" displayName="Age File Path" dataType="String" isExternalFile="True" allowDbNull="False" isRaster="True"/>
                <column name="NatDistFileName" displayName="Natural Disturbances File Path" dataType="String" isExternalFile="True" allowDbNull="False" isRaster="True"/>
                <column name="AnthroDistFileName" displayName="Anthro. Distrurbances File Path" dataType="String" isExternalFile="True" allowDbNull="False" isRaster="True"/>
                <column name="HarvFileName" displayName="Harvest File Path" dataType="String" isExternalFile="True" allowDbNull="False" isRaster="True"/>
                <column name="EskerFileNameRas" displayName="Eskers File Path" dataType="String" isExternalFile="True" isRaster="True"/>
                <column name="LinFeatFileNameRas" displayName="Linear Features file Path" dataType="String" isExternalFile="True" isRaster="True"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="SpatialInputsVectors" displayName="Input Vectors" dataScope="Scenario">
          <datasheets>
            <datasheet name="SpatialInputsVectors" displayName="Vectors">
              <columns>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="Iteration" dataType="Integer" validationType="WholeNumber" validationCondition="Greater" formula1="0" format="d" isOptional="True"/>
                <column name="Timestep" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isOptional="True"/>
                <column name="ProjectPolyFileName" displayName="Project Polygon File Path" dataType="String" allowDbNull="False" isRaster="False"/>
                <column name="EskerFileNameVec" displayName="Eskers File Path" dataType="String" isRaster="False"/>
                <column name="LinFeatFileNameVec" displayName="Linear Features file Path" dataType="String" isRaster="False"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="CaribouRange" displayName="Caribou Range" dataScope="Scenario">
          <datasheets>
            <datasheet name="CaribouRange" displayName="Caribou Range" isSingleRow="True">
              <columns>
                <column name="ScenarioID" dataType="Integer" isPrimary="True"/>
                <column name="Range" displayName="Range Name" dataType="Integer" validationType="Datasheet" formula1="CaribouRanges" allowDbNull="False"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="ModelOptions" displayName="Model Options" dataScope="Scenario">
          <datasheets>
            <datasheet name="ModelOptions" displayName="Model Options" isSingleRow="True">
              <columns>
                <column name="ScenarioID" dataType="Integer" isPrimary="True"/>
                <column name="PadProjPoly" displayName="Project Polygon Padding" dataType="Boolean"/>
                <column name="PadFocal" displayName="Focal Padding" dataType="Boolean"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
        <datafeed name="OutputHabitatUse" displayName="Output Habitat Use" dataScope="Scenario" isOutput="True">
          <datasheets>
            <datasheet name="OutputHabitatUse" displayName="Output Habitat Use">
              <columns>
                <column name="OutputHabitatUseID" dataType="Integer" isPrimary="True"/>
                <column name="Iteration" dataType="Integer" validationType="WholeNumber" validationCondition="Greater" formula1="0" format="d" isOptional="True"/>
                <column name="Timestep" dataType="Integer" validationType="WholeNumber" validationCondition="GreaterEqual" formula1="0" isOptional="True"/>
                <column name="ScenarioID" dataType="Integer"/>
                <column name="Range" displayName="Range Name" dataType="Integer" validationType="Datasheet" formula1="CaribouRanges" allowDbNull="False"/>
                <column name="Season" displayName="Season Name" dataType="Integer" validationType="Datasheet" formula1="Seasons" allowDbNull="False"/>
                <column name="HabitatUse" displayName="Habitat Use" dataType="String" isExternalFile="True" isRaster="True"/>
              </columns>
            </datasheet>
          </datasheets>
        </datafeed>
      </datafeeds>
    </transformer>
  </transformers>
  <!-- Layouts -->
  <layouts>
    <layout name="coreforms_LibraryDatafeeds">
      <item name="core_Rconfig"/>
    </layout>
    <layout name="coreforms_ProjectDatafeeds">
      <item name="FriLookUpTable"/>
      <item name="CaribouRanges"/>
      <item name="Seasons" />
    </layout>
    <layout name="coreforms_ScenarioDatafeeds">
      <item name="RunControl"/>
      <item name="InputSpadesObject"/>
      <group name="SpatialInputs" displayName="Spatial Inputs">
        <item name="SpatialInputsRasters"/>
        <item name="SpatialInputsVectors"/>
      </group>
      <item name="CaribouRange"/>
      <item name="ModelOptions"/>
      <item name="OutputHabitatUse"/>
    </layout>
    <!--Maps Layout-->
    <layout name="corestimeforms_Maps" configurationSheet="ROFSim_RunControl">
      <group name="OutputHabitatUse" displayName="Habitat Use">
        <item name="HabitatUse" displayName="Habitat Use" dataSheet="ROFSim_OutputHabitatUse" column="HabitatUse" filter="Season"/>
      </group>
    </layout>
  </layouts>
</package>